{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Admin Home</title>
    <link rel="stylesheet" href="{% static 'css/adminHome.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" />
</head>

<body>
{% include "componets/sideNav.html" %}

{% block content %}

    <div id="rightWrapper">
        <div id="header">
            <a id="fullPage" href="#">|||</a>
            <header id="profileHeader">
                <h1>welcome {{ user }}</h1>
            </header>
        </div>
            <div id="contentWrapper" style="padding-top: 500px;">
                <h1>Statistics</h1>
                <div class="row">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <canvas id="userTypeChart"></canvas>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="chart-container">
                            <canvas id="userDateChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <canvas id="runsPerDateChart"></canvas>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="chart-container">
                            <canvas id="runsPerTrainerChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="row" style="padding-bottom: 20px">
                    <div class="col-md-6">
                        <div class="chart-container">
                            <canvas id="runStatusChart"></canvas>
                        </div>
                    </div>
                </div>

                <script>
                    document.addEventListener("DOMContentLoaded", function () {
                        // Chart data
                        var userTypes = {{ user_types | safe }};
                        var userTypeCounts = {{ user_type_counts | safe }};
                        var userDates = {{ user_dates | safe }};
                        var userDateCounts = {{ user_date_counts | safe }};
                        var dates = {{ dates | safe }};
                        var runCountsPerDate = {{ run_counts_per_date | safe }};
                        var trainerIds = {{ trainer_ids | safe }};
                        var runCountsPerTrainer = {{ run_counts_per_trainer | safe }};
                        var runStatuses = {{ run_statuses | safe }};
                        var runCountsPerStatus = {{ run_counts_per_status | safe }};

                        // Chart options
                        var chartOptions = {
                            responsive: true,
                            maintainAspectRatio: false,
                        };

                        // Doughnut chart for user types
                        var ctxType = document.getElementById('userTypeChart').getContext('2d');
                        var userTypeChart = new Chart(ctxType, {
                            type: 'doughnut',
                            data: {
                                labels: userTypes,
                                datasets: [{
                                    data: userTypeCounts,
                                    backgroundColor: [
                                        'rgba(255, 99, 132, 0.5)',
                                        'rgba(54, 162, 235, 0.5)',
                                    ],
                                }],
                            },
                            options: chartOptions,
                        });

                        // Line chart for user date counts
                        var ctxDate = document.getElementById('userDateChart').getContext('2d');
                        var userDateChart = new Chart(ctxDate, {
                            type: 'line',
                            data: {
                                labels: userDates,
                                datasets: [{
                                    label: 'User Date Counts',
                                    data: userDateCounts,
                                    borderColor: 'rgba(75, 192, 192, 1)',
                                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                    borderWidth: 2,
                                    fill: true,
                                }],
                            },
                            options: {
                                ...chartOptions,
                                scales: {
                                    x: {
                                        title: {
                                            display: true,
                                            text: 'Date Joined',
                                        },
                                    },
                                    y: {
                                        beginAtZero: true,
                                    },
                                },
                            },
                        });

                        // Line chart for runs per date
                        var ctxRunsDate = document.getElementById('runsPerDateChart').getContext('2d');
                        var runsPerDateChart = new Chart(ctxRunsDate, {
                            type: 'line',
                            data: {
                                labels: dates,
                                datasets: [{
                                    label: 'Runs Per Date',
                                    data: runCountsPerDate,
                                    borderColor: 'rgba(75, 192, 192, 1)',
                                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                    borderWidth: 2,
                                    fill: true,
                                }],
                            },
                            options: {
                                ...chartOptions,
                                scales: {
                                    x: {
                                        title: {
                                            display: true,
                                            text: 'Date',
                                        },
                                    },
                                    y: {
                                        beginAtZero: true,
                                    },
                                },
                            },
                        });

                        // Doughnut chart for runs per trainer
                        var ctxTrainer = document.getElementById('runsPerTrainerChart').getContext('2d');
                        var runsPerTrainerChart = new Chart(ctxTrainer, {
                            type: 'doughnut',
                            data: {
                                labels: trainerIds,
                                datasets: [{
                                    data: runCountsPerTrainer,
                                    backgroundColor: [
                                        'rgba(255, 99, 132, 0.5)',
                                        'rgba(54, 162, 235, 0.5)',
                                    ],
                                }],
                            },
                            options: chartOptions,
                        });

                        // Bar chart for run status
                        var ctxStatus = document.getElementById('runStatusChart').getContext('2d');
                        var runStatusChart = new Chart(ctxStatus, {
                            type: 'bar',
                            data: {
                                labels: runStatuses,
                                datasets: [{
                                    label: 'Run Count Per Status',
                                    data: runCountsPerStatus,
                                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                    borderColor: 'rgba(255, 99, 132, 1)',
                                    borderWidth: 1,
                                }],
                            },
                            options: {
                                ...chartOptions,
                                scales: {
                                    x: {
                                        type: 'category', // Set the x-axis to category scale
                                        title: {
                                            display: true,
                                            text: 'Run Status',
                                        },
                                    },
                                    y: {
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Run Count',
                                        },
                                    },
                                },
                            },
                        });
                    });
                </script>
            </div>
        </div>
    {% endblock %}

    <script type="text/javascript" src="{% static '/js/adminHome.js' %}"></script>
</body>

</html>
